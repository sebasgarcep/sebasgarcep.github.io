<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.2.1" /><meta property="og:title" content="From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React" /><meta property="og:locale" content="en" /><meta name="description" content="In Part 3 we wrote our ETLs using Python and TDD. In this post we will focus on building an analytics platform for the company using CubeJS." /><meta property="og:description" content="In Part 3 we wrote our ETLs using Python and TDD. In this post we will focus on building an analytics platform for the company using CubeJS." /><link rel="canonical" href="https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/" /><meta property="og:url" content="https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/" /><meta property="og:site_name" content="Sebastian Garrido" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-06-18T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React" /><meta name="twitter:site" content="@twitter_username" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"headline":"From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React","dateModified":"2022-01-04T23:08:51-05:00","datePublished":"2021-06-18T00:00:00-05:00","description":"In Part 3 we wrote our ETLs using Python and TDD. In this post we will focus on building an analytics platform for the company using CubeJS.","url":"https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/"},"@context":"https://schema.org"}</script><title>From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React | Sebastian Garrido</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Sebastian Garrido"><meta name="application-name" content="Sebastian Garrido"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/profile.jpeg" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Sebastian Garrido</a></div><div class="site-subtitle font-italic">Data Engineer</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/sebasgarcep" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href="https://www.linkedin.com/in/sebastian-garrido-cepeda-20b090152/" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['sebasgarcep','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"> <img data-src="/assets/img/2021-06-18-from-zero-to-data-ready-part-4/dashboard.jpg" class="preview-img bg" alt="Dashboard" data-proofer-ignore><h1 data-toc-skip>From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/sebasgarcep">Sebastian Garrido</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" date="2021-06-18 00:00:00 -0500" data-toggle="tooltip" data-placement="bottom" title="Fri, Jun 18, 2021, 12:00 AM -0500" >Jun 18, 2021</em> </span> <span> Updated <em class="timeago" date="2022-01-04 23:08:51 -0500 " data-toggle="tooltip" data-placement="bottom" title="Tue, Jan 4, 2022, 11:08 PM -0500" >Jan 4, 2022</em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1313 words"> <em>7 min</em> read</span></div></div></div><div class="post-content"><p>In <a href="/posts/from-zero-to-data-ready-part-3/">Part 3</a> we wrote our ETLs using Python and TDD. In this post we will focus on building an analytics platform for the company using CubeJS.</p><h1 id="what-is-cubejs-">What is CubeJS ?</h1><p>CubeJS is a tool that serves as a backend for data analytics. If one has a data warehouse and a dashboard then CubeJS can serve as an intermediary between both. All it requires is a data model definition. With just this we can build declarative visualizations on the frontend, and it will take the responsibility of building and resolving the required queries under the hood.</p><h1 id="setting-up-cubejs">Setting up CubeJS</h1><p>To start using CubeJS we need NodeJS, and access to a compatible database, in our case Postgres. Once we have that, we can follow <a href="https://cube.dev/docs/getting-started/nodejs">these instructions</a> to setup CubeJS for our system. We can now use the following command to launch the CubeJS playground:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>npm run dev
</pre></table></code></div></div><h1 id="implementing-our-data-model">Implementing our Data Model</h1><p>Let’s implement our data model. As we discussed in a previous post, our data model has five main entities: Barcodes, Clients, Invoices, Payments, Sales. We will show how to implement invoices, the other entities will be analogous.</p><p>We can start by creating a script at <code class="language-plaintext highlighter-rouge">schema/Invoices.js</code>. CubeJS will run this script to construct the schema definition. Inside this script we have access to the <code class="language-plaintext highlighter-rouge">cube</code> function which requires two arguments: the name of the table, and an object defining its properties. It looks something like this:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nx">cube</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invoices</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">...</span>
<span class="p">})</span>
</pre></table></code></div></div><p>Inside this object we can define the base query:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre><span class="nx">cube</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invoices</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">...</span>
     <span class="na">sql</span><span class="p">:</span> <span class="s2">`
        SELECT
            id
            ,date
            ,salesperson_id
            ,salesperson_description
            ,(date + time) AS time
            ,client_id
        FROM invoices
     `</span>
    <span class="p">...</span>
<span class="p">})</span>
</pre></table></code></div></div><p>This will tell CubeJS how to get this table from the database. Notice that <code class="language-plaintext highlighter-rouge">sql</code> can be any arbitrary query, so if your analytical entity requires JOINs with many tables, CubeJS can support that!</p><p>Now let’s tell CubeJS how this table relates to others. This is important as we are often querying our objects by using filters from related tables. There are three types of relationships: <code class="language-plaintext highlighter-rouge">hasMany</code> and <code class="language-plaintext highlighter-rouge">belongsTo</code>, which define, respectively, both sides of a one-to-many relationship; <code class="language-plaintext highlighter-rouge">hasOne</code> which defines any side of a one-to-one relationship. With this in mind, our relationship definition will look like:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nx">cube</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invoices</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="na">joins</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">Clients</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">relationship</span><span class="p">:</span> <span class="dl">'</span><span class="s1">belongsTo</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.client_id = </span><span class="p">${</span><span class="nx">Clients</span><span class="p">}</span><span class="s2">.id`</span><span class="p">,</span>
        <span class="p">},</span>

        <span class="na">Payments</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">relationship</span><span class="p">:</span> <span class="dl">'</span><span class="s1">hasMany</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.id = </span><span class="p">${</span><span class="nx">Payments</span><span class="p">}</span><span class="s2">.invoice_id AND </span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.date = </span><span class="p">${</span><span class="nx">Payments</span><span class="p">}</span><span class="s2">.invoice_date`</span><span class="p">,</span>
        <span class="p">},</span>

        <span class="na">Sales</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">relationship</span><span class="p">:</span> <span class="dl">'</span><span class="s1">hasMany</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.id = </span><span class="p">${</span><span class="nx">Sales</span><span class="p">}</span><span class="s2">.invoice_id AND </span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.date = </span><span class="p">${</span><span class="nx">Sales</span><span class="p">}</span><span class="s2">.invoice_date`</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">})</span>
</pre></table></code></div></div><p>where each entry in the <code class="language-plaintext highlighter-rouge">joins</code> object is the name of the table related to this one, the <code class="language-plaintext highlighter-rouge">relationship</code> attribute will define the type of relationship these tables have, and <code class="language-plaintext highlighter-rouge">sql</code> will tell us how to join both tables.</p><p>We now have to define measures. For the case of invoices we will define only one: <code class="language-plaintext highlighter-rouge">count</code>. In CubeJS, count measures are very easy to implement:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nx">cube</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invoices</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="na">measures</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">count</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">count</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">})</span>
</pre></table></code></div></div><p>We can also implement other types of measures. At the time of writing CubeJS supports the following measure types: <code class="language-plaintext highlighter-rouge">number</code> (arbitrary measure calculated using SQL), <code class="language-plaintext highlighter-rouge">count</code>, <code class="language-plaintext highlighter-rouge">countDistinct</code>, <code class="language-plaintext highlighter-rouge">countDistinctApprox</code>, <code class="language-plaintext highlighter-rouge">sum</code>, <code class="language-plaintext highlighter-rouge">avg</code>, <code class="language-plaintext highlighter-rouge">min</code>, <code class="language-plaintext highlighter-rouge">max</code>, <code class="language-plaintext highlighter-rouge">runningTotal</code>. An example of a complex <code class="language-plaintext highlighter-rouge">sum</code> measure can be found in the <code class="language-plaintext highlighter-rouge">Sales</code> table:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="nx">cube</span><span class="p">(</span><span class="dl">'</span><span class="s1">Sales</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="na">measures</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">total_revenue</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">sum</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="dl">'</span><span class="s1">price * (1 - discount_percentage)</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">format</span><span class="p">:</span> <span class="dl">'</span><span class="s1">currency</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">})</span>
</pre></table></code></div></div><p>where sql defines the expression over which the sum occurs. Notice that we can format our measures which will improve user experience.</p><p>Finally we need to define dimensions (the properties we will use to filter over the fact tables):</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="nx">cube</span><span class="p">(</span><span class="dl">'</span><span class="s1">Invoices</span><span class="dl">'</span><span class="p">,</span> <span class="p">{</span>
    <span class="p">...</span>
    <span class="na">dimensions</span><span class="p">:</span> <span class="p">{</span>
        <span class="na">surrogate_key</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.id || '-' || </span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.date`</span><span class="p">,</span>
            <span class="na">primaryKey</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
        <span class="p">},</span>

        <span class="na">id</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="dl">'</span><span class="s1">id</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">},</span>

        <span class="na">salesperson_id</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="dl">'</span><span class="s1">salesperson_id</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">},</span>

        <span class="na">salesperson_description</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">number</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="dl">'</span><span class="s1">salesperson_description</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">},</span>

        <span class="na">time</span><span class="p">:</span> <span class="p">{</span>
            <span class="na">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">time</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">sql</span><span class="p">:</span> <span class="dl">'</span><span class="s1">time</span><span class="dl">'</span><span class="p">,</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="p">...</span>
<span class="p">})</span>
</pre></table></code></div></div><p>With CubeJS there is a caveat when it comes to dimensions. For every table, we must define a primary key by setting the <code class="language-plaintext highlighter-rouge">primaryKey</code> attribute to <code class="language-plaintext highlighter-rouge">true</code> on one of the dimensions.</p><p>In the case of invoices, the primary key is the tuple <code class="language-plaintext highlighter-rouge">(id, date)</code>. Because CubeJS does not support compound primary keys, we need to create a dimension based on an expression instead of on a column reference and use that as a primary key. Thankfully, this is trivial to do in CubeJS as the <code class="language-plaintext highlighter-rouge">sql</code> attribute supports arbitrary expressions:</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nx">surrogate_key</span><span class="p">:</span> <span class="p">{</span>
    <span class="nl">type</span><span class="p">:</span> <span class="dl">'</span><span class="s1">string</span><span class="dl">'</span><span class="p">,</span>
    <span class="nx">sql</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.id || '-' || </span><span class="p">${</span><span class="nx">Invoices</span><span class="p">}</span><span class="s2">.date`</span><span class="p">,</span>
    <span class="nx">primaryKey</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="p">},</span>
</pre></table></code></div></div><h1 id="building-a-dashboard-using-react">Building a Dashboard using React</h1><p>Now that we have a working data model for our server, we can run the CubeJS playground. Here we get three tabs, <code class="language-plaintext highlighter-rouge">Build</code>, <code class="language-plaintext highlighter-rouge">Dashboard App</code>, and <code class="language-plaintext highlighter-rouge">Schema</code>.</p><p>In <code class="language-plaintext highlighter-rouge">Schema</code> we can look at the raw tables of the database and autogenerate the schema files we manually wrote in the last section using metadata like data types, primary keys and foreign keys. This is very useful if one has a large data warehouse already and wants to rapidly migrate to CubeJS.</p><p>In <code class="language-plaintext highlighter-rouge">Build</code> we can construct visualizations using a GUI. This is very similar to how a business intelligence tool like Power BI work, with the advantage that we also get the frontend code for the visualization (which we can copy and paste into our dashboard), and the SQL code that this visualization will ultimately run in the data warehouse. There’s also an <code class="language-plaintext highlighter-rouge">Add to Dashboard</code> option, which allows us to automatically add any visualization we create here to our dashboard.</p><p><img data-src="/assets/img/2021-06-18-from-zero-to-data-ready-part-4/build-cubejs.png" alt="Build Tab in CubeJS" data-proofer-ignore></p><p>Finally, <code class="language-plaintext highlighter-rouge">Dashboard App</code> gives us the option to build our dashboard in React, Angular or Vue, using a variety of charting libraries, and with the option to either allow or disallow the end-user from creating their own visualizations.</p><p>Given that our clients have no technical expertise we will build a static dashboard, i.e. one that does not allow modifications from end-users. In our case we have a lot of expertise with React, so it makes sense to scaffold a dashboard project that uses React, Material UI and Recharts.</p><p>Most of the work was already done by the scaffolding tool, but there was one aspect that it did not solve: filtering. Our clients want to have filters at the top of the page, and the dashboard underneath it. Building the filters is relatively straightforward as Material UI has all the fields and pickers one may need. The main problem is that both the header and the dashboard need to know what the filter context is, and the header needs to be able to update it.</p><p>To make sure that the filter context is shared by both the header and the dashboard, we need to build a stateful React context and a React component to act as a context provider to the application. We’ll spare the details of how to achieve this, as it goes outside the scope of CubeJS, but there is a great example <a href="https://www.w3school.info/2021/06/05/react-context-api-with-hooks-to-make-stateful-application/">here</a>.</p><p>After these steps our application is working, and all that we need to do before the handover is polishing the design.</p><p><img data-src="/assets/img/2021-06-18-from-zero-to-data-ready-part-4/dashboard-prototype.png" alt="Dashboard Prototype" data-proofer-ignore></p><h1 id="conclusion">Conclusion</h1><p>In this series of posts we explored a possible architecture for a data infrastructure, and how to build it while following best practices. I hope that the reader can take some inspiration from this. Building data infrastructures doesn’t have to be hard!</p><h2 id="sources">Sources<a href="#sources" class="anchor"><i class="fas fa-hashtag"></i></a></h2></h2><ul><li><a href="https://github.com/sebasgarcep/from_zero_to_data_ready">From Zero to Data Ready project</a></ul></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/data-engineering/" class="post-tag no-text-decoration" >Data Engineering</a> <a href="/tags/retail-project/" class="post-tag no-text-decoration" >Retail Project</a> <a href="/tags/from-zero-to-data-ready/" class="post-tag no-text-decoration" >From Zero to Data-Ready</a> <a href="/tags/cubejs/" class="post-tag no-text-decoration" >CubeJS</a> <a href="/tags/postgres/" class="post-tag no-text-decoration" >Postgres</a> <a href="/tags/sql/" class="post-tag no-text-decoration" >SQL</a> <a href="/tags/nodejs/" class="post-tag no-text-decoration" >NodeJS</a> <a href="/tags/react/" class="post-tag no-text-decoration" >React</a> <a href="/tags/recharts/" class="post-tag no-text-decoration" >Recharts</a> <a href="/tags/material-ui/" class="post-tag no-text-decoration" >Material UI</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React - Sebastian Garrido&url=https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React - Sebastian Garrido&u=https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React - Sebastian Garrido&url=https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://sebasgarcep.github.io/posts/from-zero-to-data-ready-part-4/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recent Update</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/from-zero-to-data-ready-part-1/">From Zero to Data-Ready (Part 1): Exploratory Data Analysis</a><li><a href="/posts/from-zero-to-data-ready-part-2/">From Zero to Data-Ready (Part 2): Building a SQL Data Warehouse</a><li><a href="/posts/from-zero-to-data-ready-part-3/">From Zero to Data-Ready (Part 3): Writing Test Driven ETLs using Python</a><li><a href="/posts/from-zero-to-data-ready-part-4/">From Zero to Data-Ready (Part 4): Building Analytics Dashboards using CubeJS and React</a><li><a href="/posts/counting-primes-really-fast/">Counting Primes Really Fast</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/data-engineering/">Data Engineering</a> <a class="post-tag" href="/tags/from-zero-to-data-ready/">From Zero to Data-Ready</a> <a class="post-tag" href="/tags/retail-project/">Retail Project</a> <a class="post-tag" href="/tags/mathematics/">Mathematics</a> <a class="post-tag" href="/tags/postgres/">Postgres</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/rust/">Rust</a> <a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/cubejs/">CubeJS</a> <a class="post-tag" href="/tags/data-assimilation/">Data Assimilation</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/from-zero-to-data-ready-part-2/"><div class="card-body"> <em class="timeago small" date="2021-05-31 00:00:00 -0500" >May 31, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>From Zero to Data-Ready (Part 2): Building a SQL Data Warehouse</h3><div class="text-muted small"><p> In Part 1 we defined our problem, performed some EDA and defined a data model appropiate for data analytic purposes. In this post we will explore how to build a data warehouse and ETLs using Test D...</p></div></div></a></div><div class="card"> <a href="/posts/from-zero-to-data-ready-part-1/"><div class="card-body"> <em class="timeago small" date="2021-05-30 00:00:00 -0500" >May 30, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>From Zero to Data-Ready (Part 1): Exploratory Data Analysis</h3><div class="text-muted small"><p> Data science has been all the rage for a while. This is no accident: data science, done well, provides insights that give businesses the competitive edge you need nowadays to survive. What very few...</p></div></div></a></div><div class="card"> <a href="/posts/from-zero-to-data-ready-part-3/"><div class="card-body"> <em class="timeago small" date="2021-06-01 00:00:00 -0500" >Jun 1, 2021</em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>From Zero to Data-Ready (Part 3): Writing Test Driven ETLs using Python</h3><div class="text-muted small"><p> In Part 2 we created a data warehouse using sqitch. In this post we will focus on creating ETLs for our data. We will build our ETLs using Python under a Test Driven Development paradigm. Testing ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/from-zero-to-data-ready-part-3/" class="btn btn-outline-primary" prompt="Older"><p>From Zero to Data-Ready (Part 3): Writing Test Driven ETLs using Python</p></a> <a href="/posts/counting-primes-really-fast/" class="btn btn-outline-primary" prompt="Newer"><p>Counting Primes Really Fast</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/sebasgarcep">Sebastian Garrido</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/data-engineering/">Data Engineering</a> <a class="post-tag" href="/tags/from-zero-to-data-ready/">From Zero to Data-Ready</a> <a class="post-tag" href="/tags/retail-project/">Retail Project</a> <a class="post-tag" href="/tags/mathematics/">Mathematics</a> <a class="post-tag" href="/tags/postgres/">Postgres</a> <a class="post-tag" href="/tags/python/">Python</a> <a class="post-tag" href="/tags/rust/">Rust</a> <a class="post-tag" href="/tags/sql/">SQL</a> <a class="post-tag" href="/tags/cubejs/">CubeJS</a> <a class="post-tag" href="/tags/data-assimilation/">Data Assimilation</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
